{% extends "base.html" %}

{% block title %}{{ title }} - RemakePdf{% endblock %}

{% block content %}
<section class="tool-page">
    <div class="container">
        <a href="/" class="back-link">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 12H5"/><polyline points="12 19 5 12 12 5"/>
            </svg>
            Back to All Tools
        </a>
        
        <div class="tool-title">
            <h1>{{ title }}</h1>
            <p>{{ description }}</p>
        </div>
        
        <div class="tool-columns">
            <div class="tool-card upload-card">
                <div class="card-header">
                    <div class="card-icon" style="background: {{ color }}20;">
                        {% include "icons/" + icon + ".svg" ignore missing %}
                    </div>
                    <h3>Upload {% if 'PDF' in title %}PDF{% elif 'Word' in title %}Word{% elif 'Excel' in title %}Excel{% elif 'PowerPoint' in title %}PowerPoint{% elif 'JPG' in title %}Image{% else %}File{% endif %}</h3>
                </div>
                <div class="upload-zone" id="dropzone">
                    <div class="upload-icon-wrapper">
                        <svg class="upload-box-icon" viewBox="0 0 64 64" fill="none">
                            <path d="M52 24v28a4 4 0 01-4 4H16a4 4 0 01-4-4V24" stroke="#3b82f6" stroke-width="3" stroke-linecap="round"/>
                            <path d="M8 24l24-16 24 16" stroke="#1d4ed8" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M32 24v20" stroke="#3b82f6" stroke-width="3" stroke-linecap="round"/>
                            <path d="M24 36l8 8 8-8" stroke="#3b82f6" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <h4>Drop your {% if 'PDF' in title %}PDF{% elif 'Word' in title %}Word file{% elif 'Excel' in title %}Excel file{% elif 'PowerPoint' in title %}PowerPoint{% elif 'JPG' in title %}images{% else %}file{% endif %} here</h4>
                    <p>or click to browse files</p>
                    <input type="file" id="fileInput" name="files" accept="{{ accept }}" {% if multiple %}multiple{% endif %} hidden>
                    <input type="file" id="addMoreInput" name="addFiles" accept="{{ accept }}" {% if multiple %}multiple{% endif %} hidden>
                    <button type="button" class="btn btn-select" id="browseBtn">Select {% if 'PDF' in title %}PDF{% elif 'Word' in title %}Word{% elif 'Excel' in title %}Excel{% elif 'PowerPoint' in title %}PPTX{% elif 'JPG' in title %}Images{% else %}File{% endif %}</button>
                </div>
                <div class="thumbnail-grid" id="thumbnailGrid" style="display: none;" data-multiple="{% if multiple %}true{% else %}false{% endif %}">
                    <div class="thumbnails-container" id="thumbnailsContainer"></div>
                    {% if multiple %}
                    <button type="button" class="add-more-btn" id="addMoreBtn" title="Add more files">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                    </button>
                    {% endif %}
                </div>
            </div>
            
            <div class="tool-card settings-card">
                <form id="uploadForm" enctype="multipart/form-data">
                    <div class="card-header">
                        <div class="card-icon settings-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
                            </svg>
                        </div>
                        <h3>{% if tool_name == 'compress' %}Compression Settings{% elif tool_name == 'rotate' %}Rotation Settings{% elif tool_name == 'split' %}Split Options{% elif tool_name == 'pdf-to-jpg' %}Output Quality{% elif tool_name == 'ocr' %}OCR Settings{% elif tool_name == 'extract' %}Extract Options{% elif tool_name == 'protect' %}Security Settings{% elif tool_name == 'unlock' %}Unlock Settings{% elif tool_name == 'watermark' %}Watermark Settings{% elif tool_name == 'sign' %}Signature Settings{% elif tool_name == 'edit' %}Edit Settings{% elif tool_name == 'crop' %}Crop Settings{% elif tool_name == 'remove-pages' %}Page Selection{% elif tool_name == 'organize' %}Page Order{% else %}Settings{% endif %}</h3>
                    </div>
                    
                    <div class="settings-content">
                        {% if tool_name == 'compress' %}
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="quality" value="low">
                                <span class="radio-custom"></span>
                                <div class="radio-text">
                                    <strong>Extreme Compression</strong>
                                    <small>Smallest file size, lower quality (72 DPI)</small>
                                </div>
                            </label>
                            <label class="radio-option selected">
                                <input type="radio" name="quality" value="medium" checked>
                                <span class="radio-custom"></span>
                                <div class="radio-text">
                                    <strong>Medium Compression</strong>
                                    <small>Recommended - good balance (150 DPI)</small>
                                </div>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="quality" value="high">
                                <span class="radio-custom"></span>
                                <div class="radio-text">
                                    <strong>Low Compression</strong>
                                    <small>Best quality, larger file size (200 DPI)</small>
                                </div>
                            </label>
                        </div>
                        {% elif tool_name == 'rotate' %}
                        <div class="radio-group">
                            <label class="radio-option selected">
                                <input type="radio" name="angle" value="90" checked>
                                <span class="radio-custom"></span>
                                <div class="radio-text">
                                    <strong>90° Clockwise</strong>
                                    <small>Rotate pages to the right</small>
                                </div>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="angle" value="180">
                                <span class="radio-custom"></span>
                                <div class="radio-text">
                                    <strong>180° Rotation</strong>
                                    <small>Flip pages upside down</small>
                                </div>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="angle" value="270">
                                <span class="radio-custom"></span>
                                <div class="radio-text">
                                    <strong>90° Counter-clockwise</strong>
                                    <small>Rotate pages to the left</small>
                                </div>
                            </label>
                        </div>
                        <div class="input-group">
                            <label>Apply to pages:</label>
                            <input type="text" name="pages" placeholder="all (or e.g., 1-3, 5)" value="all">
                        </div>
                        {% elif tool_name == 'split' %}
                        <div class="radio-group">
                            <label class="radio-option selected">
                                <input type="radio" name="split_type" value="all" id="splitAll" checked>
                                <span class="radio-custom"></span>
                                <div class="radio-text">
                                    <strong>Extract All Pages</strong>
                                    <small>Create separate PDF for each page</small>
                                </div>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="split_type" value="range" id="splitRange">
                                <span class="radio-custom"></span>
                                <div class="radio-text">
                                    <strong>Custom Page Ranges</strong>
                                    <small>Select specific pages to extract</small>
                                </div>
                            </label>
                        </div>
                        <div class="input-group" id="pagesGroup" style="display: none;">
                            <label>Page ranges:</label>
                            <input type="text" name="pages" placeholder="e.g., 1-3, 5, 7-10">
                        </div>
                        {% elif tool_name == 'pdf-to-jpg' %}
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="dpi" value="72">
                                <span class="radio-custom"></span>
                                <div class="radio-text">
                                    <strong>Low Quality (72 DPI)</strong>
                                    <small>Smaller files, faster processing</small>
                                </div>
                            </label>
                            <label class="radio-option selected">
                                <input type="radio" name="dpi" value="150" checked>
                                <span class="radio-custom"></span>
                                <div class="radio-text">
                                    <strong>Medium Quality (150 DPI)</strong>
                                    <small>Good balance for most uses</small>
                                </div>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="dpi" value="300">
                                <span class="radio-custom"></span>
                                <div class="radio-text">
                                    <strong>High Quality (300 DPI)</strong>
                                    <small>Best for printing</small>
                                </div>
                            </label>
                        </div>
                        {% elif tool_name == 'extract' %}
                        <div class="radio-group">
                            <label class="radio-option selected">
                                <input type="radio" name="extract_type" value="text" checked>
                                <span class="radio-custom"></span>
                                <div class="radio-text">
                                    <strong>Extract Text</strong>
                                    <small>Get all text content from PDF</small>
                                </div>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="extract_type" value="images">
                                <span class="radio-custom"></span>
                                <div class="radio-text">
                                    <strong>Extract Images</strong>
                                    <small>Get all embedded images</small>
                                </div>
                            </label>
                        </div>
                        {% elif tool_name == 'ocr' %}
                        <div class="radio-group">
                            <label class="radio-option selected">
                                <input type="radio" name="language" value="eng" checked>
                                <span class="radio-custom"></span>
                                <div class="radio-text"><strong>English</strong></div>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="language" value="fra">
                                <span class="radio-custom"></span>
                                <div class="radio-text"><strong>French</strong></div>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="language" value="deu">
                                <span class="radio-custom"></span>
                                <div class="radio-text"><strong>German</strong></div>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="language" value="spa">
                                <span class="radio-custom"></span>
                                <div class="radio-text"><strong>Spanish</strong></div>
                            </label>
                        </div>
                        {% elif tool_name == 'protect' %}
                        <div class="input-group">
                            <label>Set Password:</label>
                            <input type="password" name="password" placeholder="Enter a strong password" required>
                            <small>Your PDF will be encrypted with this password</small>
                        </div>
                        {% elif tool_name == 'unlock' %}
                        <div class="input-group">
                            <label>PDF Password:</label>
                            <input type="password" name="password" placeholder="Enter the current password">
                            <small>Leave empty if the PDF has no password</small>
                        </div>
                        {% elif tool_name == 'watermark' %}
                        <div class="input-group">
                            <label>Watermark Text:</label>
                            <input type="text" name="text" placeholder="CONFIDENTIAL" value="WATERMARK">
                        </div>
                        <div class="input-group">
                            <label>Opacity: <span id="opacityValue">30%</span></label>
                            <input type="range" name="opacity" min="0.1" max="1" step="0.1" value="0.3" id="opacitySlider">
                        </div>
                        {% elif tool_name == 'sign' %}
                        <div class="signature-container">
                            <label>Draw your signature:</label>
                            <canvas id="signatureCanvas" width="360" height="120"></canvas>
                            <button type="button" class="btn btn-secondary btn-small" id="clearSignature">Clear</button>
                            <input type="hidden" name="signature" id="signatureData">
                        </div>
                        <div class="position-group">
                            <div class="input-group">
                                <label>X Position:</label>
                                <input type="number" name="x" value="100">
                            </div>
                            <div class="input-group">
                                <label>Y Position:</label>
                                <input type="number" name="y" value="700">
                            </div>
                            <div class="input-group">
                                <label>Page:</label>
                                <input type="number" name="page" value="1" min="1">
                            </div>
                        </div>
                        {% elif tool_name == 'edit' %}
                        <div class="input-group">
                            <label>Text to add:</label>
                            <textarea name="text" rows="3" placeholder="Enter text to add to PDF"></textarea>
                        </div>
                        <div class="position-group">
                            <div class="input-group">
                                <label>X:</label>
                                <input type="number" name="x" value="100">
                            </div>
                            <div class="input-group">
                                <label>Y:</label>
                                <input type="number" name="y" value="100">
                            </div>
                            <div class="input-group">
                                <label>Page:</label>
                                <input type="number" name="page" value="1" min="1">
                            </div>
                        </div>
                        {% elif tool_name == 'crop' %}
                        <div class="crop-inputs">
                            <div class="input-group">
                                <label>Top (pt):</label>
                                <input type="number" name="top" value="0" min="0">
                            </div>
                            <div class="input-group">
                                <label>Bottom (pt):</label>
                                <input type="number" name="bottom" value="0" min="0">
                            </div>
                            <div class="input-group">
                                <label>Left (pt):</label>
                                <input type="number" name="left" value="0" min="0">
                            </div>
                            <div class="input-group">
                                <label>Right (pt):</label>
                                <input type="number" name="right" value="0" min="0">
                            </div>
                        </div>
                        {% elif tool_name == 'remove-pages' %}
                        <div class="input-group">
                            <label>Pages to remove:</label>
                            <input type="text" name="pages" placeholder="e.g., 1, 3-5, 8" required>
                            <small>Enter page numbers or ranges separated by commas</small>
                        </div>
                        {% elif tool_name == 'organize' %}
                        <div class="input-group">
                            <label>New page order:</label>
                            <input type="text" name="order" placeholder="e.g., 3, 1, 2, 5, 4" required>
                            <small>Enter page numbers in desired order</small>
                        </div>
                        {% else %}
                        <div class="no-settings">
                            <p>No additional settings needed. Just upload your file and process!</p>
                        </div>
                        {% endif %}
                    </div>
                    
                    <button type="submit" class="btn btn-process" id="processBtn" style="--tool-color: {{ color }}">
                        <span class="btn-text">{{ title }}</span>
                        <span class="btn-loading" style="display: none;">
                            <svg class="spinner" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none" stroke-dasharray="30 70"/></svg>
                            Processing...
                        </span>
                    </button>
                </form>
            </div>
        </div>
        
        <div class="result-area" id="resultArea" style="display: none;">
            <div class="result-card">
                <svg class="success-icon" viewBox="0 0 24 24" fill="none" stroke="#27ae60" stroke-width="2">
                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/>
                </svg>
                <h2>Success!</h2>
                <p id="resultMessage">Your file has been processed successfully.</p>
                <div class="download-buttons" id="downloadButtons"></div>
                <button class="btn btn-secondary" id="processAnother">Process Another File</button>
            </div>
        </div>
        
        <div class="error-area" id="errorArea" style="display: none;">
            <div class="error-card">
                <svg class="error-icon" viewBox="0 0 24 24" fill="none" stroke="#e74c3c" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/>
                </svg>
                <h2>Error</h2>
                <p id="errorMessage">Something went wrong.</p>
                <button class="btn btn-primary" id="tryAgain">Try Again</button>
            </div>
        </div>
    </div>
</section>

{% include "partials/article.html" %}
{% endblock %}

{% block scripts %}
<script>
    const toolName = "{{ tool_name }}";
</script>
<script src="{{ url_for('static', filename='js/upload.js') }}"></script>
{% if tool_name == 'sign' %}
<script src="{{ url_for('static', filename='js/signature.js') }}"></script>
{% endif %}
<script>
document.querySelectorAll('.radio-option input').forEach(radio => {
    radio.addEventListener('change', function() {
        document.querySelectorAll('.radio-option').forEach(opt => opt.classList.remove('selected'));
        this.closest('.radio-option').classList.add('selected');
    });
});
const splitAll = document.getElementById('splitAll');
const splitRange = document.getElementById('splitRange');
const pagesGroup = document.getElementById('pagesGroup');
if (splitAll && splitRange && pagesGroup) {
    splitAll.addEventListener('change', () => pagesGroup.style.display = 'none');
    splitRange.addEventListener('change', () => pagesGroup.style.display = 'block');
}
const opacitySlider = document.getElementById('opacitySlider');
const opacityValue = document.getElementById('opacityValue');
if (opacitySlider && opacityValue) {
    opacitySlider.addEventListener('input', () => opacityValue.textContent = Math.round(opacitySlider.value * 100) + '%');
}
</script>
{% endblock %}
